<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Reporte de ventas</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/flaskst.css') }}">
</head>

<body>
  <header>
    <nav>
      <a href="{{ url_for('index') }}">Reportes</a>
    </nav>
  </header>

  <main>
    <h3>Reporte de ventas</h3>
    <p>Generado: {{ generated_on.strftime("%Y-%m-%d %H:%M UTC") }}</p>

    <form action="{{ url_for('reports_download') }}" method="post">
      <input type="hidden" name="date_from" value="{{ filters.date_from or '' }}">
      <input type="hidden" name="date_to"   value="{{ filters.date_to or '' }}">
      <input type="hidden" name="product_id" value="{{ filters.product_id or '' }}">
      <input type="hidden" name="categoria"  value="{{ filters.categoria or '' }}">
      <input type="hidden" name="group_by"   value="{{ filters.group_by or 'product' }}">


      <button type="submit">Descargar PDF</button>
      <a href="{{ url_for('reports_form') }}">Volver</a>
    </form>

    <table>
      <thead>
        <tr>
          <th>Grupo</th>
          <th>Cantidad</th>
          <th>Ventas (MXN)</th>
        </tr>
      </thead>

      <tbody>
        {% for r in report %}
        <tr>
          <td>{{ r.grupo }}</td>
          <td>{{ r.cantidad }}</td>
          <td>{{ "{:,.2f}".format(r.ventas) }}</td>
        </tr>
        {% endfor %}
      </tbody>

      <tfoot>
        <tr>
          <th>Totales</th>
          <th>{{ total_items }}</th>
          <th>{{ "{:,.2f}".format(total_amount) }}</th>
        </tr>
      </tfoot>

    </table>
  </main>
</body>

</html>